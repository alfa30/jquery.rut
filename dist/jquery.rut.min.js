!function(t){"use strict";function n(t){return t.replace(/[\.\-]/g,"")}function r(t){var n=l(t),r=n[0],e=n[1];if(!r||!e)return r||t;for(var o="";r.length>3;)o="."+r.substr(r.length-3)+o,r=r.substring(0,r.length-3);return r+o+"-"+e}function e(t){return t.type&&t.type.match(/^key(up|down|press)/)&&(8==t.keyCode||16==t.keyCode||17==t.keyCode||18==t.keyCode||20==t.keyCode||27==t.keyCode||37==t.keyCode||38==t.keyCode||39==t.keyCode||40==t.keyCode||91==t.keyCode)}function o(t){if("string"!=typeof t)return!1;var r=n(t);if(r.length<2)return!1;var e=r.charAt(r.length-1).toUpperCase(),o=parseInt(r.substr(0,r.length-1));return 0/0===o?!1:u(o).toString().toUpperCase()===e}function u(t){var n=0,r=2;if("number"!=typeof t)return 0/0;t=t.toString();for(var e=t.length-1;e>=0;e--)n+=t.charAt(e)*r,r=(r+1)%8||2;switch(n%11){case 1:return"k";case 0:return 0;default:return 11-n%11}}function i(t){t.val(r(t.val()))}function a(t){o(t.val())?t.trigger("rutValido",l(t.val())):t.trigger("rutInvalido")}function l(t){var r=n(t);if(0==r.length)return[null,null];if(1==r.length)return[r,null];var e=r.charAt(r.length-1),o=r.substring(0,r.length-1);return[o,e]}var s={validateOn:"blur",formatOn:"blur",ignoreControlKeys:!0},f={init:function(n){if(this.length>1)for(var r=0;r<this.length;r++)console.log(this[r]),t(this[r]).rut(n);else{var o=this;o.opts=t.extend({},s,n),o.opts.formatOn&&o.on(o.opts.formatOn,function(t){return o.opts.ignoreControlKeys&&e(t)?0/0:void i(o,t)}),o.opts.validateOn&&o.on(o.opts.validateOn,function(t){a(o,t)})}return this}};t.fn.rut=function(n){return f[n]?f[n].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof n&&n?void t.error("El mÃ©todo "+n+" no existe en jQuery.rut"):f.init.apply(this,arguments)},t.formatRut=function(t){return r(t)},t.validateRut=function(n,r){if(o(n)){var e=l(n);return t.isFunction(r)&&r(e[0],e[1]),!0}return!1},t(function(){var n=window.stopDrValidaRut;(null==n||0==n)&&t("[validarut]").each(function(n,r){var r=t(r),e={},o=r.data("format-on"),u=r.data("validate-on");""!=o&&null!=o&&(e.formatOn=o),""!=u&&null!=u&&(e.validateOn=u),r.rut(e)})})}(jQuery);